/*! Dashicons Media Modal - v0.1.0
 * 
 * Copyright (c) 2016; * Licensed none */
!function(a,b,c,d){"use strict";b.JST={},b.JST["dashicons-list-item-view"]=_.template('<div class="dashicons item <%= className %> attachment" data-id="<%= id %>"><a href="#" id="dashicons-check-<%= id %>" data-id="<%= id %>" class="check" title="Deselect"><div class="media-modal-icon"></div></a></div>'),b.JST["dashicon-view"]=_.template('<i class="dashicons <%= className %>"></i>');var e=Backbone.Model.extend({defaults:{title:"","class":""}}),f=Backbone.Collection.extend({model:e}),g=Backbone.View.extend({tagName:"li",template:JST["dashicons-list-item-view"],initialize:function(a){this.model.bind("change",this.render)},render:function(){var a={id:this.model.get("id"),name:this.model.get("name"),className:this.model.get("class")};return this.$el.html(this.template(a)),this}}),h=Backbone.View.extend({template:JST["dashicon-view"],initialize:function(a){this.model.bind("change",this.render)},render:function(){return this.$el.html(this.getHTML()),this},getHTML:function(){var a={className:this.model.get("class")};return this.template(a)}}),i=c.media.view.Toolbar.extend({initialize:function(){_.defaults(this.options,{close:!1,items:{insertButton:{text:"Insert into post",style:"primary",priority:80,requires:!1,click:this.sendToEditor}}}),c.media.view.Toolbar.prototype.initialize.apply(this,arguments)},refresh:function(){c.media.view.Toolbar.prototype.refresh.apply(this,arguments),this.refreshButtons()},refreshButtons:function(){var a=this.controller.state().selection;this.getInsertButtonModel().set("disabled",!a.length)},getInsertButtonModel:function(){return this.get("insertButton").model},sendToEditor:function(){this.controller.state().sendToEditor()}}),j=c.media.View.extend({tagName:"ul",className:"media-dashicons attachments clearfix",events:{"click .dashicons.item":"toggleSelection","click .dashicon .check":"removeSelection"},initialize:function(a){this.collection=a.collection},render:function(){var a=this;return this.collection.forEach(function(b){var c=new g({model:b});a.$el.append(c.render().el)}),this},getSelection:function(){return this.controller.state().selection},addToSelection:function(a,b){a.closest(".dashicons.item").addClass("selected details"),this.getSelection().add(this.collection._byId[b]),this.controller.state().selection.trigger("change")},removeFromSelection:function(a,b){a.closest(".dashicons.item").removeClass("selected details"),this.getSelection().remove(this.collection._byId[b]),this.controller.state().selection.trigger("change")},resetSelection:function(){this.getSelection().reset()},toggleSelection:function(b){var c=a(b.currentTarget),d=c.attr("data-id");this.getSelection().get(d)?this.removeFromSelection(c,d):this.addToSelection(c,d)}}),k=function(a){this.initialize(a)};k.prototype={container:null,initialize:function(a){this.container=a.container,this.setMediaFrame()},setMediaFrame:function(){var a=c.media.view.MediaFrame.Post;c.media.view.MediaFrame.Post=a.extend({initialize:function(){a.prototype.initialize.apply(this,arguments),this.on("content:render:dashicons",this.setDashiconsContent,this),this.on("toolbar:create:dashicons",this.setDashiconsToolbar,this)},createStates:function(){a.prototype.createStates.call(this),this.states.add([new l({id:"dashicons",menu:"default",content:"dashicons",title:"Insert Dashicon",priority:200,toolbar:"dashicons",type:"link"})])},setDashiconsToolbar:function(a){a.view=new i({controller:this})},setDashiconsContent:function(){this.$el.addClass("hide-router");var a=this.getDashiconsData(),b=new j({controller:this,collection:a});this.content.set(b)},getDashiconsData:function(){return new f([{id:"dashicons-yes","class":"dashicons-yes",name:"Yes"},{id:"dashicons-no","class":"dashicons-no",name:"No"},{id:"dashicons-plus","class":"dashicons-plus",name:"Plus"},{id:"dashicons-minus","class":"dashicons-minus",name:"Minus"},{id:"dashicons-star-filled","class":"dashicons-star-filled",name:"Star"},{id:"dashicons-star-half","class":"dashicons-star-half",name:"Half Star"},{id:"dashicons-star-empty","class":"dashicons-star-empty",name:"Empty Star"},{id:"dashicons-flag","class":"dashicons-flag",name:"Flag"},{id:"dashicons-warning","class":"dashicons-warning",name:"Warning"},{id:"dashicons-download","class":"dashicons-download",name:"Download"},{id:"dashicons-upload","class":"dashicons-upload",name:"Upload"},{id:"dashicons-lightbulb","class":"dashicons-lightbulb",name:"Lightbulb"},{id:"dashicons-phone","class":"dashicons-phone",name:"Phone"},{id:"dashicons-thumbs-up","class":"dashicons-thumbs-up",name:"Thumbs Up"},{id:"dashicons-thumbs-down","class":"dashicons-thumbs-down",name:"Thumbs Down"},{id:"dashicons-paperclip","class":"dashicons-paperclip",name:"Paperclip"},{id:"dashicons-chart-pie","class":"dashicons-chart-pie",name:"Pie Chart"},{id:"dashicons-chart-bar","class":"dashicons-chart-bar",name:"Bar Chart"}])}})}};var l=c.media.controller.State.extend({selection:new Backbone.Collection,initialize:function(a){this.selection.on("change",this.refresh,this)},refresh:function(){this.frame.toolbar.get().refresh()},getFrameContent:function(){return this.frame.content.get()},getSelection:function(){return 0===this.selection.length?this.getFrameContent().getSelection():this.selection},sendToEditor:function(){var a=this.getSelection();this.isTinymce()?this.insertHTML(a):this.insertPlainText(a),this.selection.reset(),this.frame.close()},insertHTML:function(a){c.media.editor.insert(this.getHTMLContent(a))},insertPlainText:function(a){c.media.editor.insert(this.getHTMLContent(a))},getHTMLContent:function(a){var b="";return a.each(function(a){var c=new h({model:a});b+=c.getHTML()},this),b},isTinymce:function(){return"undefined"!=typeof tinymce&&null!==tinymce.activeEditor&&!tinymce.activeEditor.isHidden()}}),m=function(){};m.prototype={run:function(){this.mediaFrame=new k({container:this})}},m=new m,m.run()}(jQuery,window,wp);